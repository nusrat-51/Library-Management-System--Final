@model LibraryManagementSystem.Models.FinePayment

@{
    ViewData["Title"] = "Cash Receipt";

    // realtime generated values (no DB changes)
    var generatedAt = DateTime.Now;

    // cashier (logged in manager/admin email)
    var cashier = User?.Identity?.Name ?? "Manager";

    // fine breakdown (optional but looks professional)
    // If you stored FineAmount already, this is still safe:
    // We calculate days late based on BookApplicationId record only if you want.
    // Since we don't have BookApplication model here, we keep it receipt style:
    // show Rate/Day + Total (best effort).
    decimal finePerDay = 10m;
}

<div class="container py-4">
    <div class="receipt-shell" id="receiptArea">

        <!-- Header -->
        <div class="receipt-top">
            <div class="brand">
                <div class="brand-title">Library Management System</div>
                <div class="brand-sub">Official Cash Payment Receipt</div>
            </div>

            <div class="receipt-meta">
                <div class="meta-row">
                    <span class="meta-label">Receipt #</span>
                    <span class="meta-value">@Model.TranId</span>
                </div>
                <div class="meta-row">
                    <span class="meta-label">Generated</span>
                    <span class="meta-value">@generatedAt.ToString("MMM dd, yyyy hh:mm tt")</span>
                </div>
            </div>
        </div>

        <div class="dash"></div>

        <!-- Customer / Transaction -->
        <div class="section">
            <div class="section-title">Payment Details</div>

            <div class="grid">
                <div class="label">Student Email</div>
                <div class="value">@Model.StudentEmail</div>

                <div class="label">Book Application ID</div>
                <div class="value">@Model.BookApplicationId</div>

                <div class="label">Payment Method</div>
                <div class="value">
                    <span class="pill pill-dark">@Model.Gateway</span>
                </div>

                <div class="label">Status</div>
                <div class="value">
                    <span class="pill pill-success">@Model.Status</span>
                </div>

                <div class="label">Cashier</div>
                <div class="value">@cashier</div>

                <div class="label">Paid At</div>
                <div class="value">@Model.PaidAt?.ToString("MMM dd, yyyy hh:mm tt")</div>
            </div>
        </div>

        <div class="dash"></div>

        <!-- Amount Summary -->
        <div class="section">
            <div class="section-title">Amount Summary</div>

            <div class="summary">
                <div class="sum-row">
                    <span>Fine Rate / Day</span>
                    <span>৳@finePerDay.ToString("0.00")</span>
                </div>

                <div class="sum-row sum-total">
                    <span>Total Paid</span>
                    <span>৳@Model.Amount.ToString("0.00")</span>
                </div>
            </div>

            <div class="note">
                This receipt is generated by the system in real-time. Keep it for your records.
            </div>
        </div>

        <div class="dash"></div>

        <!-- Footer -->
        <div class="receipt-footer">
            <div class="thanks">Thank you for your payment.</div>
            <div class="small">
                Support: library@support.com &nbsp;|&nbsp; Powered by LMS
            </div>
        </div>
    </div>

    <!-- Buttons -->
    <div class="d-flex gap-2 mt-3 no-print">
        <button class="btn btn-primary" onclick="window.print()">
            <i class="bi bi-printer me-2"></i>Print Receipt
        </button>

        <a class="btn btn-outline-secondary" asp-controller="BookApplication" asp-action="Index">
            <i class="bi bi-arrow-left me-2"></i>Back to Applications
        </a>
    </div>
</div>

<link rel="stylesheet" href="~/css/cash-receipt.css" />
